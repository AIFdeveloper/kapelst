<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú–∞–≥–∞–∑–∏–Ω –¥–µ—Ç—Å–∫–æ–π –æ–¥–µ–∂–¥—ã ‚Äî –ö–∞–ø–µ–ª—å–∫–∞ —Å—á–∞—Å—Ç—å—è</title>
  <style>
    :root{ --bg:#f6f9fc; --card:#ffffff; --accent:#06b6d4; --accent-2:#0891b2; --muted:#6b7280; --danger:#ef4444; --muted-2:#374151}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, Roboto, Arial, sans-serif;background:var(--bg);color:#0f172a}
    header{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:12px;font-weight:700;}
    .logo{width:44px;height:44px;background:white;border-radius:10px;display:flex;align-items:center;justify-content:center;color:var(--accent);font-weight:800}
    .search{flex:1;max-width:640px}
    .search input{width:100%;padding:10px 12px;border-radius:10px;border:0}
    .header-actions{display:flex;gap:8px;align-items:center}
    .btn{background:white;color:var(--accent);padding:8px 10px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
    main{padding:18px;display:grid;grid-template-columns:1fr 340px;gap:18px;max-width:1200px;margin:18px auto}
    .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(2,6,23,0.06);display:flex;flex-direction:column;gap:8px}
    .thumb{height:110px;width:110px;border-radius:10px;background:linear-gradient(135deg,#fff,#eef6fb);display:flex;align-items:center;justify-content:center;font-size:36px;overflow:hidden}
    .thumb img{width:110px;height:110px;object-fit:cover;display:block}
    .title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .price{color:var(--accent);font-weight:800}
    .meta{font-size:13px;color:var(--muted)}
    .card .row{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:6px}
    .buy{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:8px 10px;border-radius:8px;border:0;cursor:pointer}
    .card-flex{display:flex;gap:10px;align-items:center}
    .card-flex .info{flex:1;min-width:0}
    .cart{background:var(--card);padding:12px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.06)}
    .cart h3{margin:0 0 8px 0}
    .cart-list{display:flex;flex-direction:column;gap:8px;max-height:420px;overflow:auto;padding-right:4px}
    .cart-item{display:flex;gap:8px;align-items:center}
    .cart-item .mini{width:48px;height:48px;border-radius:8px;background:#f1f5f9;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .cart-item .mini img{width:48px;height:48px;object-fit:cover;display:block}
    .qty{display:flex;gap:6px;align-items:center}
    .qty button{width:28px;height:28px;border-radius:6px;border:0;background:#eef2f7;cursor:pointer}
    .total{font-weight:800;margin-top:12px}
    .checkout{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    footer{padding:18px;text-align:center;color:var(--muted)}
    @media (max-width:980px){main{grid-template-columns:1fr 300px;padding:14px}}
    @media (max-width:760px){main{grid-template-columns:1fr} .cart{order:-1}}
    #adminPanel{position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); display:none; align-items:flex-start; justify-content:center; padding-top:40px; z-index:99999; overflow:auto;}
    #adminPanel .box{background:white;padding:18px;border-radius:12px; max-width:760px;width:94%;display:flex;flex-direction:column;gap:12px;box-shadow:0 10px 40px rgba(2,6,23,0.4)}
    .admin-grid{display:grid;grid-template-columns:1fr 320px;gap:12px}
    .admin-list{display:flex;flex-direction:column;gap:8px;max-height:380px;overflow:auto;padding-right:6px}
    .admin-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;background:#f8fafc}
    .admin-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
    .admin-actions{display:flex;gap:8px;margin-left:auto}
    .muted{font-size:13px;color:var(--muted)}
    .small{font-size:13px;color:var(--muted-2)}
    .danger{background:var(--danger);color:white;border-radius:8px;padding:6px 8px;border:0;cursor:pointer}
    input[type="file"]{padding:6px 4px}
    .form-row{display:flex;gap:8px}
    .form-row input{flex:1}
    @media (max-width: 920px) { main { grid-template-columns: 1fr 280px; padding: 14px; gap: 14px; } }
    @media (max-width: 760px) { main { grid-template-columns: 1fr; } .cart { order: -1; margin-bottom: 20px; } }
    @media (max-width: 600px) {
      header { flex-direction: column; align-items: stretch; gap: 10px; }
      .search { width: 100%; order: 1; }
      .header-actions { width: 100%; display: flex; justify-content: flex-end; order: 2; }
      .btn { width: auto; font-size: 14px; padding: 8px 10px; }
      .logo { width: 36px; height: 36px; font-size: 20px; }
      .products { grid-template-columns: 1fr; gap: 12px; }
      .thumb { height: 100px; width: 100px; }
      .card-flex { flex-direction: row; gap: 8px; align-items: center; }
    }
    .products .card, .cart, #adminPanel .box { transition: all 0.3s ease; }
    header, header .brand, header .header-actions, header .search { transition: all 0.3s ease; }
    .admin-grid { grid-template-columns: 1fr 1fr; }
    @media (max-width: 700px) { .admin-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">‚ù§Ô∏è</div>
    <div>
      <div>–ö–∞–ø–µ–ª—å–∫–∞ —Å—á–∞—Å—Ç—å—è</div>
      <div style="font-size:12px;color:rgba(255,255,255,0.9)">–ú–∞–≥–∞–∑–∏–Ω –¥–µ—Ç—Å–∫–æ–π –æ–¥–µ–∂–¥—ã</div>
    </div>
  </div>

  <div class="search" style="min-width:220px">
    <input id="searchInput" placeholder="–ü–æ–∏—Å–∫: –ø–ª–∞—Ç—å—è, –∫—É—Ä—Ç–∫–∏, 3-4 –≥–æ–¥–∞..." />
  </div>

  <div class="header-actions">
    <button id="viewCartBtn" class="btn">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="cartCount">0</span>)</button>
    <button id="adminBtn" class="btn" style="background:#fff3f2;color:#b91c1c">–ê–¥–º–∏–Ω</button>
  </div>
</header>

<main>
  <section>
    <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
    <div class="products" id="products"></div>
  </section>

  <aside class="cart" id="cart">
    <h3>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h3>
    <div class="cart-list" id="cartList"></div>
    <div class="total">–ò—Ç–æ–≥–æ: <span id="cartTotal">0</span> —Å</div>

    <div class="checkout">
      <input id="nameInput" placeholder="–í–∞—à–µ –∏–º—è" />
      <input id="phoneInput" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ email" />
      <button id="checkoutBtn" class="buy">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      <button id="clearBtn" style="background:#f3f4f6;border:0;padding:8px;border-radius:8px;cursor:pointer">–û—á–∏—Å—Ç–∏—Ç—å</button>
    </div>
  </aside>
</main>

<template id="productTpl">
  <div class="card">
    <div class="card-flex">
      <div class="thumb"></div>
      <div class="info">
        <div class="title"></div>
        <div class="meta"></div>
        <div class="row" style="margin-top:8px;">
          <div class="price"></div>
          <button class="buy">–í –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
      </div>
    </div>
  </div>
</template>

<div id="adminPanel" aria-hidden="true">
  <div class="box" role="dialog" aria-label="–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <h3 style="margin:0">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
      <div style="display:flex;gap:8px">
        <button id="closeAdminBtn" class="btn" style="background:#f3f4f6;color:var(--muted)">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button id="addNewBtn" class="btn" style="background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white">–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä</button>
      </div>
    </div>

    <div class="admin-grid">
      <div>
        <div style="font-weight:700;margin-bottom:6px">–§–æ—Ä–º–∞ —Ç–æ–≤–∞—Ä–∞</div>

        <div id="formWrap">
          <div class="form-row">
            <input id="aName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" />
            <input id="aPrice" placeholder="–¶–µ–Ω–∞" type="number" />
          </div>
          <div class="form-row">
            <input id="aAge" placeholder="–í–æ–∑—Ä–∞—Å—Ç (2-3 –≥–æ–¥–∞)" />
            <input id="aColor" placeholder="–¶–≤–µ—Ç (–†–æ–∑–æ–≤—ã–π)" />
          </div>

          <div style="display:flex;gap:8px;align-items:center;margin-top:6px">
            <div style="flex:1">
              <label class="small">–§–æ—Ç–æ (110√ó110)</label>
              <input id="aImage" type="file" accept="image/*" />
            </div>
            <div id="imgPreview" style="display:none">
              <img id="imgPreviewImg" style="width:110px;height:110px;object-fit:cover;border-radius:8px" alt="preview"/>
              <div style="text-align:center;margin-top:6px">
                <button id="removePreviewBtn" style="padding:6px;border-radius:8px;border:0;background:#f3f4f6;cursor:pointer">–£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ</button>
              </div>
            </div>
          </div>

          <div style="display:flex;gap:8px;margin-top:10px">
            <button id="saveProductBtn" class="buy">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button id="cancelEditBtn" style="padding:8px;border-radius:8px;border:0;background:#eee">–û—Ç–º–µ–Ω–∞</button>
            <button id="deleteProductBtn" class="danger" style="display:none">–£–¥–∞–ª–∏—Ç—å</button>
          </div>

          <div style="display:flex;gap:8px;margin-top:10px">
            <button id="exportBtn" style="padding:8px;border-radius:8px;border:0;background:#e6f7ff;cursor:pointer">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å products.json</button>
            <div class="muted" style="margin-top:8px">–ü–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞: –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ –≤–∞—à —Ö–æ—Å—Ç–∏–Ω–≥ (–≤ —Ç—É –∂–µ –ø–∞–ø–∫—É, –≥–¥–µ index.html).</div>
          </div>

          <div class="muted" style="margin-top:8px">–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –±–µ–∑ —Ñ–æ—Ç–æ ‚Äî –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç–º–æ–¥–∑–∏/–ø—É—Å—Ç–∞—è –∏–∫–æ–Ω–∫–∞.</div>
        </div>
      </div>

      <div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</div>
          <div class="small muted">–í—Å–µ–≥–æ: <span id="adminCount">0</span></div>
        </div>

        <div class="admin-list" id="adminList"></div>
      </div>
    </div>
  </div>
</div>

<script>
const DEFAULT_PRODUCTS = [
  {id:1,name:'–ü–ª–∞—Ç—å–µ "–†–∞–¥—É–≥–∞" (2-3 –≥–æ–¥–∞)',price:200,age:'2-3 –≥–æ–¥–∞',color:'–†–æ–∑–æ–≤–æ–µ',emoji:"üëó",image:"img/img1.jfif"},
  {id:2,name:'–ö—É—Ä—Ç–∫–∞ –∑–∏–º–Ω—è—è (4-5 –ª–µ—Ç)',price:189,age:'4-5 –ª–µ—Ç',color:'–°–∏–Ω—è—è',emoji:"üß•",image:"img/img2.jfif"},
  {id:3,name:'–ö—É—Ä—Ç–∫–∞ –∑–∏–º–Ω—è—è (4-5 –ª–µ—Ç)',price:350,age:'4-5 –ª–µ—Ç',color:'–°–∏–Ω—è—è',emoji:"üß•",image:"img/img3.jfif"}
];

let BASE_PRODUCTS = [];
let CUSTOM_PRODUCTS = JSON.parse(localStorage.getItem('kids_custom_products')||'[]');
let CART = JSON.parse(localStorage.getItem('kids_cart')||'{}');

/* –≠–ª–µ–º–µ–Ω—Ç—ã */
const productsRoot = document.getElementById('products');
const tpl = document.getElementById('productTpl');
const searchInput = document.getElementById('searchInput');
const cartList = document.getElementById('cartList');
const cartCount = document.getElementById('cartCount');
const cartTotal = document.getElementById('cartTotal');

const adminPanel = document.getElementById('adminPanel');
const adminBtn = document.getElementById('adminBtn');
const closeAdminBtn = document.getElementById('closeAdminBtn');
const addNewBtn = document.getElementById('addNewBtn');

const aName = document.getElementById('aName');
const aPrice = document.getElementById('aPrice');
const aAge = document.getElementById('aAge');
const aColor = document.getElementById('aColor');
const aImage = document.getElementById('aImage');
const imgPreview = document.getElementById('imgPreview');
const imgPreviewImg = document.getElementById('imgPreviewImg');
const removePreviewBtn = document.getElementById('removePreviewBtn');

const saveProductBtn = document.getElementById('saveProductBtn');
const cancelEditBtn = document.getElementById('cancelEditBtn');
const deleteProductBtn = document.getElementById('deleteProductBtn');
const adminList = document.getElementById('adminList');
const adminCount = document.getElementById('adminCount');
const exportBtn = document.getElementById('exportBtn');

const nameInput = document.getElementById('nameInput');
const phoneInput = document.getElementById('phoneInput');

let editingId = null;
const ADMIN_PASSWORD = "12345";

/* –£—Ç–∏–ª–∏—Ç—ã */
function saveCustom(){ localStorage.setItem('kids_custom_products', JSON.stringify(CUSTOM_PRODUCTS)); }
function saveCart(){ localStorage.setItem('kids_cart', JSON.stringify(CART)); }
function getAllProducts(){ return [...BASE_PRODUCTS, ...CUSTOM_PRODUCTS]; }
function flash(text){
  const el=document.createElement('div'); el.textContent=text;
  el.style.position='fixed'; el.style.right='18px'; el.style.bottom='18px';
  el.style.background='rgba(0,0,0,0.8)'; el.style.color='white';
  el.style.padding='8px 12px'; el.style.borderRadius='8px'; el.style.zIndex=999999;
  document.body.appendChild(el);
  setTimeout(()=>el.style.opacity=0,1400); setTimeout(()=>el.remove(),2000);
}

/* –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ */
function renderProducts(list){
  productsRoot.innerHTML='';
  if(list.length===0){ productsRoot.innerHTML='<div style="color:var(--muted)">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>'; return; }
  list.forEach(p=>{
    const node = tpl.content.cloneNode(true);
    const thumbEl = node.querySelector('.thumb');
    if(p.image){ thumbEl.innerHTML=`<img src="${p.image}" alt="">`; }
    else { thumbEl.textContent=p.emoji||'üì¶'; }
    node.querySelector('.title').textContent = p.name;
    node.querySelector('.meta').textContent = `${p.age} ‚Ä¢ ${p.color}`;
    node.querySelector('.price').textContent = p.price+' —Å';
    node.querySelector('.buy').onclick = ()=>{ addToCart(p.id); };
    productsRoot.appendChild(node);
  });
}

/* –ö–æ—Ä–∑–∏–Ω–∞ */
function renderCart(){
  cartList.innerHTML='';
  let total=0, count=0;
  Object.entries(CART).forEach(([id,qty])=>{
    const p = getAllProducts().find(x=>x.id==id);
    if(!p) return;
    const row = document.createElement('div'); row.className='cart-item';
    const mini = document.createElement('div'); mini.className='mini';
    if(p.image){ mini.innerHTML=`<img src="${p.image}">`; } else { mini.textContent=p.emoji||'üì¶'; }
    row.appendChild(mini);
    const info = document.createElement('div'); info.style.flex='1'; info.textContent=p.name;
    row.appendChild(info);
    const qtyWrap = document.createElement('div'); qtyWrap.className='qty';
    const btnMinus = document.createElement('button'); btnMinus.textContent='-';
    const btnPlus = document.createElement('button'); btnPlus.textContent='+';
    const span = document.createElement('span'); span.textContent=qty;
    btnMinus.onclick=()=>{ if(CART[id]>1){CART[id]--; saveCart(); renderCart();} else {delete CART[id]; saveCart(); renderCart();} };
    btnPlus.onclick=()=>{ CART[id]++; saveCart(); renderCart(); };
    qtyWrap.appendChild(btnMinus); qtyWrap.appendChild(span); qtyWrap.appendChild(btnPlus);
    row.appendChild(qtyWrap);
    cartList.appendChild(row);
    total+=p.price*qty; count+=qty;
  });
  cartTotal.textContent = total;
  cartCount.textContent = count;
}

/* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É */
function addToCart(id){ 
  if(CART[id]){ CART[id]++; } else { CART[id]=1; }
  saveCart(); renderCart();
}

/* –ü–æ–∏—Å–∫ */
searchInput.addEventListener('input', e=>{
  const term = e.target.value.toLowerCase();
  renderProducts(getAllProducts().filter(p=>{
    return p.name.toLowerCase().includes(term) || p.age.toLowerCase().includes(term) || p.color.toLowerCase().includes(term);
  }));
});

/* –ê–¥–º–∏–Ω */
adminBtn.onclick=()=>{
  const pwd = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏:");
  if(pwd!==ADMIN_PASSWORD){ alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'); return; }
  adminPanel.style.display='flex';
  renderAdminList();
};
closeAdminBtn.onclick=()=>{ adminPanel.style.display='none'; };
addNewBtn.onclick=()=>{ editingId=null; aName.value=''; aPrice.value=''; aAge.value=''; aColor.value=''; aImage.value=''; imgPreview.style.display='none'; deleteProductBtn.style.display='none'; };

/* –§–æ—Ä–º–∞ */
aImage.onchange=(e)=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload=()=>{ imgPreviewImg.src = reader.result; imgPreview.style.display='block'; }
    reader.readAsDataURL(file);
  }
}
removePreviewBtn.onclick=()=>{ aImage.value=''; imgPreview.style.display='none'; imgPreviewImg.src=''; }

/* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ */
saveProductBtn.onclick=()=>{
  const name=aName.value.trim(), price=Number(aPrice.value), age=aAge.value.trim(), color=aColor.value.trim(), image=imgPreviewImg.src||'', emoji='üì¶';
  if(!name||!price){ alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É'); return; }
  if(editingId){
    const idx = CUSTOM_PRODUCTS.findIndex(x=>x.id==editingId);
    if(idx!==-1){ CUSTOM_PRODUCTS[idx]={...CUSTOM_PRODUCTS[idx],name,price,age,color,image,emoji}; }
  }else{
    const newId = Date.now();
    CUSTOM_PRODUCTS.push({id:newId,name,price,age,color,image,emoji});
  }
  saveCustom(); renderProducts(getAllProducts()); renderAdminList(); flash('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
};

/* –£–¥–∞–ª–µ–Ω–∏–µ */
deleteProductBtn.onclick=()=>{
  if(editingId){
    CUSTOM_PRODUCTS = CUSTOM_PRODUCTS.filter(x=>x.id!=editingId);
    saveCustom(); renderProducts(getAllProducts()); renderAdminList(); flash('–£–¥–∞–ª–µ–Ω–æ'); 
    editingId=null; deleteProductBtn.style.display='none';
  }
};

/* –û—Ç–º–µ–Ω–∞ */
cancelEditBtn.onclick=()=>{ editingId=null; deleteProductBtn.style.display='none'; }

/* –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω */
function renderAdminList(){
  adminList.innerHTML='';
  const all = getAllProducts();
  adminCount.textContent=all.length;
  all.forEach(p=>{
    const div = document.createElement('div'); div.className='admin-item';
    const img = document.createElement('img'); if(p.image) img.src=p.image; else img.alt=p.emoji||'üì¶';
    div.appendChild(img);
    const info = document.createElement('div'); info.style.flex='1'; info.textContent=p.name;
    div.appendChild(info);
    const actions = document.createElement('div'); actions.className='admin-actions';
    const btnEdit = document.createElement('button'); btnEdit.textContent='–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å'; btnEdit.className='btn';
    btnEdit.onclick=()=>{
      editingId=p.id; aName.value=p.name; aPrice.value=p.price; aAge.value=p.age; aColor.value=p.color;
      if(p.image){ imgPreviewImg.src=p.image; imgPreview.style.display='block'; } else { imgPreview.style.display='none'; }
      deleteProductBtn.style.display='inline-block';
    }
    actions.appendChild(btnEdit);
    div.appendChild(actions);
    adminList.appendChild(div);
  });
}

/* –≠–∫—Å–ø–æ—Ä—Ç */
exportBtn.onclick=()=>{
  const data = JSON.stringify(getAllProducts(),null,2);
  const blob = new Blob([data],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='products.json'; a.click(); URL.revokeObjectURL(url);
}

/* –ó–∞–∫–∞–∑ */
document.getElementById('checkoutBtn').onclick=()=>{
  if(Object.keys(CART).length===0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞'); return; }
  const name = nameInput.value.trim(), phone = phoneInput.value.trim();
  if(!name||!phone){ alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω'); return; }
  alert(`–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n–ò–º—è: ${name}\n–ö–æ–Ω—Ç–∞–∫—Ç: ${phone}\n–¢–æ–≤–∞—Ä–æ–≤: ${Object.keys(CART).length}`);
  CART={}; saveCart(); renderCart(); nameInput.value=''; phoneInput.value='';
}
document.getElementById('clearBtn').onclick=()=>{ CART={}; saveCart(); renderCart(); }

/* –ó–∞–≥—Ä—É–∑–∫–∞ JSON */
async function loadProductsJson(){
  try{
    const resp = await fetch('products.json',{cache:'no-store'});
    if(!resp.ok) throw new Error('no file');
    const data = await resp.json();
    if(Array.isArray(data)){ BASE_PRODUCTS = data; }
  }catch(err){ BASE_PRODUCTS = DEFAULT_PRODUCTS; console.warn('products.json not found - using default'); }
  renderProducts(getAllProducts());
  renderCart();
  renderAdminList();
}

loadProductsJson();
</script>
</body>
</html>
